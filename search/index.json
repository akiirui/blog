[{"content":"起因 由于汉字在东亚地区的广泛使用，以及各个地区的文化发展，同一个汉字可能在不同的地区有着不同字形。\n在没有配置 Fontconfig 的情况下，可能会出现简体中文的汉字错误的显示为了日语汉字字形的问题。\n这个问题在 Windows 下近乎无解。但是在 Linux 下，我们可以自由的配置 Fontconfig 在系统层面几乎完美的解决这个问题。\n需求 我个人的需求是，拉丁字符使用特定的字体。而 CJK 字符则按照语言选择所需的字形。\n于是要优先使用拉丁字体。如果某个字符不在其中，则使用后备的 CJK 字体。\n字体 在这里，我使用了以下这些字体来进行配置。当然，你也可以选择你喜欢的字体。\n   Charset Serif Sans Mono     Latin PT Serif Roboto Cascadia Code   CJK Noto Serif CJK Noto Sans CJK Noto Sans Mono CJK    还有 Noto Color Emoji 作为 Emoji 字体。\n配置 由于完整配置太长，为了文章的简洁，我只简单介绍每一个文件是如何配置的，以便于各位使用时按需自定义。\n完整配置储存在 Gist \u0026gt; Customize Fontconfig 。\n拉丁字符 52-latin.conf \u0026lt;alias binding=\u0026#34;strong\u0026#34;\u0026gt; \u0026lt;family\u0026gt;serif\u0026lt;/family\u0026gt; \u0026lt;prefer\u0026gt; \u0026lt;family\u0026gt;PT Serif\u0026lt;/family\u0026gt; \u0026lt;/prefer\u0026gt; \u0026lt;/alias\u0026gt; 在拉丁字符部分，使用 alias \u0026amp; prefer 使所需的字体成为第一个匹配项。\nbinding=\u0026quot;strong\u0026quot; 是为了使这条规则不会被顺序更靠后的配置文件给覆盖。\nfamily 的值则按照需要更改为 sans-serif monospace system-ui 。\nCJK 字符 53-cjk.conf \u0026lt;match target=\u0026#34;pattern\u0026#34;\u0026gt; \u0026lt;test name=\u0026#34;family\u0026#34;\u0026gt; \u0026lt;string\u0026gt;serif\u0026lt;/string\u0026gt; \u0026lt;/test\u0026gt; \u0026lt;edit name=\u0026#34;family\u0026#34; mode=\u0026#34;append\u0026#34; binding=\u0026#34;strong\u0026#34;\u0026gt; \u0026lt;string\u0026gt;Noto Serif CJK SC\u0026lt;/string\u0026gt; \u0026lt;/edit\u0026gt; \u0026lt;/match\u0026gt; 在 CJK 字符部分，使用 match \u0026amp; test 匹配字体家族，然后用 edit mode=\u0026quot;append\u0026quot; 使所需的字体成为紧随拉丁字体的后备字体。\n这一条规则是当没有提供 lang 属性的时候的默认值，按需更改字形变体。\n\u0026lt;!-- \u0026#34;lang=zh-hant\u0026#34; or \u0026#34;lang=zh-hant-*\u0026#34; --\u0026gt; \u0026lt;match target=\u0026#34;pattern\u0026#34;\u0026gt; \u0026lt;test name=\u0026#34;lang\u0026#34; compare=\u0026#34;contains\u0026#34;\u0026gt; \u0026lt;string\u0026gt;zh-hant\u0026lt;/string\u0026gt; \u0026lt;/test\u0026gt; \u0026lt;test name=\u0026#34;family\u0026#34;\u0026gt; \u0026lt;string\u0026gt;serif\u0026lt;/string\u0026gt; \u0026lt;/test\u0026gt; \u0026lt;edit name=\u0026#34;family\u0026#34; mode=\u0026#34;append\u0026#34; binding=\u0026#34;strong\u0026#34;\u0026gt; \u0026lt;string\u0026gt;Noto Serif CJK TC\u0026lt;/string\u0026gt; \u0026lt;/edit\u0026gt; \u0026lt;/match\u0026gt; 此规则是当提供了 lang 属性时选择的字形变体，匹配 zh-hant 或 zh-hant-* （忽略大小写）。\n放置在后面则可以覆盖上面所配置的 CJK 字符默认值。\n常见的 lang 属性    Chinese Japanese Korean     zh ja ko   zh-CN ja-jp ko-kr   zh-TW     zh-HK     zh-Hans     zh-Hant     zh-Hant-HK      Emoji 😆 54-emoji.conf \u0026lt;match target=\u0026#34;pattern\u0026#34;\u0026gt; \u0026lt;test name=\u0026#34;family\u0026#34;\u0026gt; \u0026lt;string\u0026gt;serif\u0026lt;/string\u0026gt; \u0026lt;/test\u0026gt; \u0026lt;edit name=\u0026#34;family\u0026#34; mode=\u0026#34;append_last\u0026#34; binding=\u0026#34;strong\u0026#34;\u0026gt; \u0026lt;string\u0026gt;Noto Color Emoji\u0026lt;/string\u0026gt; \u0026lt;/edit\u0026gt; \u0026lt;/match\u0026gt; 这条规则是将 Emoji 字体放置于后备字体列表的末尾。当然，它依然优先于其他没有在配置文件中列出的字体。\n测试 我们可以使用 fc-match 来测试 Fontconfig。\n按照 Gist \u0026gt; Customize Fontconfig 的配置，最终的结果如下。\n \n你可能会发现最后一个测试 lang=zh 居然匹配到了 HK 字形？这可能是 fc-match 的 Bug ，实际使用时会正常匹配到 SC 字形。\n最后 虽然配置 Fontconfig 可以几乎完美的达成需求，但是在某些不遵循 Fontconfig 的应用程序中就无可奈何了。\n Chromium 系\nChromium 只在 UI 字体上遵循 Fontconfig，并且 CJK 的后备字体是硬编码的。你只有使用 Advanced Font Settings 来设置每种语言标签的字体。\n 还好 Linux 下大多数应用都遵循了 Fontconfig 。立即转投 Firefox 吧！\n","date":"2021-03-26T17:54:11+08:00","image":"https://blog.akii.art/p/fontconfig-for-cjk/cover_hucfa0b5dec8e3216df2e9d3a92434c16d_130583_120x120_fill_box_smart1_2.png","permalink":"https://blog.akii.art/p/fontconfig-for-cjk/","title":"CJK 用户们的 Fontconfig"},{"content":"多年之前曾经创建过一个小站，不过因为种种原因荒废掉了。\n域名也因为没有续费被回收。（随后被人注册，成了一个奇奇怪怪的广告站）\n并且所有数据都在我某次清理时全部删除了。\n最近热血来潮又重新创建这个小站。\n打算记录一些笔记什么的，除了这些，我这个「真・潜水党」也没啥别的好写了。\n不过也没人看就对了～ 😅\n最后。你好，Hugo！\n","date":"2021-03-26T15:04:08+08:00","image":"https://blog.akii.art/p/hello-hugo/cover_hua8b05c2676dd97b4df3df07a5b7569ae_18157_120x120_fill_box_smart1_2.png","permalink":"https://blog.akii.art/p/hello-hugo/","title":"Hello, Hugo!"}]